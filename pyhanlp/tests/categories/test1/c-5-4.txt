**题目**
多参数移动健康监护终端的设计与实现
**关键字**
慢性病,移动健康,集成模拟前端,多参数,频谱分析
**摘要**
在当今的医疗状况下,由于患者连续性健康信息数据缺失,医生往往依靠主诉判断既往情况,然而患者就医的时间节点在疾病出现后,使医生无法了解对于缓慢累积的重大慢性非传染性疾病(Chronic non-communicable disease, NCD)酝酿情况及个人形成原因,这些情况均导致医生的诊断准确性在一定程度上受到了影响；重大慢性疾病酝酿早期时,任何器官均没有明显器质性变化,只是功能性变化阶段,无法选择有针对性的预防性项目；同时,个人体检项目为普遍性筛查,难以依照个人身体状况和遗传情况等需求因素进行选择安排；慢性病患者,尤其是老年慢性病患者在户内外活动时,会有不慎摔倒的情况,当出现突发病症或不慎摔倒时,医生和家人经常不能及时得到通知并获取相关的生理参数,结果延误了治疗时机,增加医疗风险。
针对当前医疗资源的不足、分布不均,以及慢性病需长期监护、合理干预、科学管理的需求,对慢性病患者尤其是老年慢性病患者的日常监护和健康管理尤为重要。通过便携式生理监护终端,将使用者的生理参数,如心电、心率、血氧饱和度等进行实时采集和存储,并上传至健康管理中心,医生可以根据这些生理信息及时对使用者的健康状况做出评估,以实现慢性病患者的健康促进、并发症预防、病情延缓、生活质量提高,同时达到降低医疗费用、合理配置医疗资源的目标,最终完成我国慢性病“由治到防”的转变。
作为心血管疾病预防治疗的最主要诊断依据,心电图(Electrocardiography, ECG)对心脏功能检查和病理研究具有非常重要的参考意义,当心脏的活动状态出现异常时,会导致心电信号周期的变快或变慢,甚至导致ECG波形的畸变；及时检测动脉中氧含量是否充分,是判断人体呼吸系统和循环系统是否正常或者周围环境是否缺氧的重要指标,临床上一般通过测量血氧饱和度来判断人体血液中的氧含量；老年人和慢性病患者的自理能力和自我保护能力比较差,由于绊倒、扭伤或自身疾病,比如心脑血管疾病等因素,常常会造成这个群体中个体的意外跌倒。如果得不到及时的救助,这种跌倒经常会导致比较严重的后果。综上所述,心电、血氧饱和度和跌倒监测都是慢性病患者家庭日常保健与监护的必要项目。
本课题研究的目标就是设计一款功能全面、便携、安全、低耗、智能的家用微型便携式多参数移动健康监护终端。该移动健康监护终端可以实现人体心电、心率、血氧饱和度和姿态信息的采集、处理、显示与存储,并通过蓝牙与Android或iOS智能手机进行数据交互,在使用者生理参数异常或跌倒时发出报警信号。智能手机还可以通过2G/3G/4G或者WiFi网络将使用者的生理信息上传至社区健康服务网站,医生将根据获得的信息制作更详细的电子健康档案。
多参数移动健康监护终端的硬件设计方案应具遵循以下原则：(1)使用安全,检测结果准确、可靠：(2)操作便捷,体积小,功能全面;(3)功耗低；(4)互联功能。根据这些设计原则,本文采用意法半导体公司的STM32F103系列单片机作为控制单元核心,跌倒监测模块采用三轴加速度传感器MMA7260。心电和血氧饱和度的监测均使用集成化的设计方案,分别使用TI公司的脉搏血氧模拟前端AFE4400和心电模拟前端ADS1298进行信号采集。与常规分立元件组成的采集系统相比较,基于模拟前端的心电和血氧饱和度采集电路具有高精度、低功耗、体积小、宽采样、低噪声干扰和功能全面等优点。
设计的移动健康监护终端采用800mAh可装卸聚合物锂离子可充电电池,稳压电路分别输出+3.3v和+3.0v电压为数字电路和模拟电路供电。单片机分别将血氧信号采集模块、心电信号采集模块和三轴加速度传感器得到的脉搏波信号、心电信号和人体加速度信号依次进行特定的算法处理,得到当前使用者的心率值、血氧饱和度值、脉搏波、心电波形和身体姿态状况,这些参数同时在LCD显示屏上实时更新与显示。使用者还可以选择将得到的生理参数通过蓝牙模块实时发送至智能手机,从而使监护数据的显示、保存、报警和数据上传便捷化和智能化。
心电和脉搏波属于低频信号,频带范围分别为0.05-100Hz和0-20Hz,人体活动的加速度信号99%能量集中在15Hz以下,根据奈奎斯特采样定理,设定心电信号的采集周期为4ms,光电脉搏波信号和人体加速度信号的采集周期均为12ms,系统采用分时调度机制进行数据采集和处理。终端通过蓝牙模块以串口通信的方式与智能设备进行数据交互,其发送的数据包主要有模块自检信息、控制命令应答、功能设置信息、系统运行状态、监护波形数据和生理参数数据六种。
心电信号、光电脉搏波信号和人体加速度信号都非常容易受到工频干扰、电子设备噪声和基线漂移等内外部因素的影响,进而造成信号失真,测量结果出现较大误差,严重影响健康监护终端的正常使用。经硬件电路采集到的生理信号需要由单片机进行进一步的分析和处理才能得到我们需要的稳定准确的心电波形、心率值、脉搏波波形、血氧饱和度值和人体姿态信息。本研究使用MATLAB的FDAtool工具箱进行FIR数字滤波器的设计,为了提高设计的滤波器在STM32单片机上的运行效率,在将得到的滤波器输出为C语言类型的文件时还需要将将浮点型滤波器系数转化为整型系数。针对信号中的基线漂移干扰,采用滑动平滑滤波的方法实现基线漂移的抑制。
本研究采用动态差分阈值的方法进行光电容积脉搏波和心电波形的特征点识别,实验证明,设计的特征点识别算法可以准确识别脉搏波的波峰、波谷和心电R波。为了提高计算结果的稳定性,本研究在计算血氧饱和度时采用频谱分析法来提取脉搏波的直流分量和交流分量,利用意法半导体公司提供的DSP固件库,我们可以方便地在STM32F103单片机上实现快速傅里叶变换,该方法要优于基于时域特征点识别的血氧饱和度算法。正确提取出脉搏波的直流和交流分量之后,即可计算得到R值,然后使用FLUKE公司的Prosim-8生命体征模拟仪对设计的血氧模块在70%～100%范围内进行定标,采集多次数据并进行拟合之后发现二次拟合结果可以更好地反映出血氧饱和度随R值的变化趋势,因此在实际应用中,一般使用二次拟合结果来计算人体血氧饱和度。
人体跌倒时,身体的加速度信息相比日常生活的正常动作(Activities of Daily Life, ADL)会有很大的变化,通过分析人体加速度信息的变化,监护终端即可在使用者跌倒时正确识别并发出求救信号。
本文设计的移动健康监护终端的心电监测有多种增益选择,心率和脉搏的测量范围为30～220bpm。利用设计的健康监护终端对8名年龄为22～28周岁的受测者在安静状态下同时采集三导联心电信号和脉搏波信号,计算其心率和血氧饱和度值,并与某商用便携式多参数监护仪的测量结果进行对比,结果显示心率和脉搏的测量精度为±3bpm,血氧饱和度在90%～99%范围内精度为±2%,均在允许的误差范围之内,此外,跌倒报警系统对三种典型跌倒动作的正确报警率也在90%以上。
实践证明,本文设计的多参数移动健康监护终端测量准确,具有友好的人机交互界面,携带方便,与智能手机的无线连接功能体现了当今大力社会发展远程医疗与远程保健服务的趋势,为国内智能化医疗与移动健康的发展提供了参考,具有较高的使用价值及发展前景。
